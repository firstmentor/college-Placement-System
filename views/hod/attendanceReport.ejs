<%- include('../layouts/navbar.ejs') %>
<%- include('../layouts/sidebar.ejs') %>

<div class="content-wrapper">
  <div class="content-header">
    <div class="container-fluid">
      <h1 class="m-0 text-dark">Attendance Report</h1>
    </div>
  </div>

  <div class="content">
    <div class="container-fluid">
      <!-- Filter Form -->
      <form action="/hod/attendance/report" method="GET" class="form-inline mb-4">
        <label for="branch" class="mr-2">Department:</label>
        <select name="branch" id="branch" class="form-control mr-3" required>
          <option value="">Select Branch</option>
          <option value="CSE">CSE</option>
          <option value="IT">IT</option>
          <option value="EC">EC</option>
          <option value="AI">AI</option>
          <option value="MCA">MCA</option>
        </select>

        <label for="semester" class="mr-2">Semester:</label>
        <select name="semester" id="semester" class="form-control mr-3" required>
          <option value="">Select Semester</option>
          <% for (let i = 1; i <= 8; i++) { %>
            <option value="<%= i %>"><%= i %>th Sem</option>
          <% } %>
        </select>

        <button type="submit" class="btn btn-primary">Filter</button>
      </form>

      <!-- Table -->
      <table class="table table-bordered table-striped">
        <thead>
          <tr>
            <th>Student</th>
            <th>Date</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <% if (records.length === 0) { %>
            <tr><td colspan="3">No records found.</td></tr>
          <% } else { %>
            <% records.forEach(r => { %>
              <tr>
                <td><%= r.studentId.name %></td>
                <td><%= r.date.toDateString() %></td>
                <td><%= r.status %></td>
              </tr>
            <% }) %>
          <% } %>
        </tbody>
      </table>

      <!-- Export Buttons -->
      <div class="mt-3">
        <a href="/hod/attendance/export/pdf?branch=<%= branch %>&semester=<%= semester %>" class="btn btn-danger">Export PDF</a>
        <a href="/hod/attendance/export/excel?branch=<%= branch %>&semester=<%= semester %>" class="btn btn-success">Export Excel</a>
      </div>
    </div>
  </div>
</div>

<%- include('../layouts/footer.ejs') %>
